@page "/"
@using LightBDD.Reporting.Progressive.UI.Services
@inject InteropService Interop;
@inject EventRepository Repository;
@implements IDisposable;

@foreach (var feat in Repository.Features.OrderBy(f => f.Name.Name))
{
    <FeatureView Model="@feat" />
}

@code
{
    public string Version { get; set; }
    public string Data { get; set; }

    protected override async Task OnInitializedAsync()
    {
        Repository.OnUpdate += HandleRefresh;
        await Interop.Initialize();
    }

    private void HandleRefresh()
    {
        StateHasChanged();
    }

    public void Dispose()
    {
        Repository.OnUpdate -= HandleRefresh;
    }
}
